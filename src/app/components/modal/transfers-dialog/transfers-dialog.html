<mat-card>
    <mat-card-header>
        <mat-card-title>User transfers</mat-card-title>
        <mat-card-subtitle>Current balance: {{user?.balance}}</mat-card-subtitle>
    </mat-card-header>
    <mat-card-content>
        <form [formGroup]="transferForm">
            <mat-form-field>
                <mat-label>Transfer type</mat-label>
                <mat-select formControlName="type">
                    <mat-option value="Payment">Payment</mat-option>
                    <mat-option value="Withdrawal">Withdrawal</mat-option>
                </mat-select>
                @if (transferForm.get('role')?.invalid && transferForm.get('role')?.touched) {
                <mat-error>Type is required</mat-error>
                }
            </mat-form-field>
            <mat-form-field>
                <mat-label>EUR</mat-label>
                <input matInput type="number" formControlName="amount">
            </mat-form-field>
            <button matButton="tonal" [disabled]="transferForm.invalid" (click)="transfer()"><mat-icon>save</mat-icon>Save</button>
        </form>
        <table mat-table [dataSource]="transfers">
    <tr mat-header-row *matHeaderRowDef="cols"></tr>
    <tr mat-row *matRowDef="let row; columns: cols;"
        [ngClass]="{ 'transferMinus': row.buyer != null, 'transferPlus': row.seller != null}"></tr>
    <ng-container matColumnDef="amount">
        <th mat-header-cell *matHeaderCellDef> Amount </th>
        <td mat-cell *matCellDef="let transfer">
            @if(transfer.buyer != null) {
            +
            }
            @if(transfer.seller != null) {
            -
            }
            {{transfer.amount}} </td>
    </ng-container>
    <ng-container matColumnDef="time">
        <th mat-header-cell *matHeaderCellDef> Time </th>
        <td mat-cell *matCellDef="let transfer"> {{transfer.time | date:"long"}} </td>
    </ng-container>
    <ng-container matColumnDef="type">
        <th mat-header-cell *matHeaderCellDef> Type </th>
        <td mat-cell *matCellDef="let transfer">{{transfer.type}}</td>
    </ng-container>
    <ng-container matColumnDef="buyer">
        <th mat-header-cell *matHeaderCellDef> Buyer </th>
        <td mat-cell *matCellDef="let transfer">{{transfer.buyer}}</td>
    </ng-container>
    <ng-container matColumnDef="seller">
        <th mat-header-cell *matHeaderCellDef> Seller </th>
        <td mat-cell *matCellDef="let transfer">{{transfer.seller}}</td>
    </ng-container>
    <ng-container matColumnDef="item">
        <th mat-header-cell *matHeaderCellDef> Item </th>
        <td mat-cell *matCellDef="let transfer">{{transfer.item}}</td>
    </ng-container>
</table>
    </mat-card-content>
    <mat-card-actions>
        <div class="spacer"></div>
        <button matButton (click)="close()"><mat-icon>close</mat-icon>Close</button>
    </mat-card-actions>
</mat-card>