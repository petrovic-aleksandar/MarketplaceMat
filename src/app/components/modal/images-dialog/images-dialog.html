<mat-card>
    <mat-card-header>
        <mat-card-title>Images</mat-card-title>
        <mat-card-subtitle>Manage item images</mat-card-subtitle>
    </mat-card-header>
    <mat-card-content>

        <img [src]="path()" class="img">

        <table mat-table [dataSource]="images">
            <tr mat-header-row *matHeaderRowDef="cols"></tr>
            <tr mat-row *matRowDef="let row; columns: cols;"></tr>
            <ng-container matColumnDef="path">
                <th mat-header-cell *matHeaderCellDef> Image </th>
                <td mat-cell *matCellDef="let i"> {{i.path}} </td>
            </ng-container>
            <ng-container matColumnDef="front">
                <th mat-header-cell *matHeaderCellDef> Front </th>
                <td mat-cell *matCellDef="let i"> {{i.front ? "Front" : ""}} </td>
            </ng-container>
            <ng-container matColumnDef="actions">
                <th mat-header-cell *matHeaderCellDef> Actions </th>
                <td mat-cell *matCellDef="let i">
                    <button matButton="outlined" (click)="view(i)" [disabled]="i===image">View</button>
                    <button matButton="outlined" (click)="makeFront(i)" [disabled]="i.front">Front</button>
                    <button matButton="outlined" (click)="delete(i)" [disabled]="i.front">Delete</button>
                </td>
            </ng-container>
        </table>

        <input type="file" class="file-input" [accept]="requiredFileType" (change)="onFileSelected($event)" #fileUpload>

        <div class="file-upload">
            {{fileName || "No file uploaded yet."}}
            <button matButton="tonal" mat-mini-fab color="primary" class="upload-btn" (click)="fileUpload.click()">
                <mat-icon>attach_file</mat-icon>Choose file
            </button>
        </div>

        <div class="progress">
            @if (uploadProgress) {
            <mat-progress-bar class="progress-bar" mode="determinate" [value]="uploadProgress" />
            <mat-icon class="cancel-upload" (click)="cancelUpload()">delete_forever</mat-icon>
            }
        </div>

    </mat-card-content>
    <mat-card-actions>
        <div class="spacer"></div>
        <button mat-button (click)="close()"><mat-icon>close</mat-icon>Close</button>
    </mat-card-actions>
</mat-card>